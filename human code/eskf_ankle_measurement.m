function [yout,y_dx] = eskf_ankle_measurement(in1,in2,in3,dt,in5,in6,in7)
%ESKF_ANKLE_MEASUREMENT
%    [YOUT,Y_DX] = ESKF_ANKLE_MEASUREMENT(IN1,IN2,IN3,DT,IN5,IN6,IN7)

%    This function was generated by the Symbolic Math Toolbox version 8.6.
%    30-Aug-2021 16:53:29

footp1 = in1(1,:);
footp2 = in1(2,:);
footp3 = in1(3,:);
footv1 = in1(4,:);
footv2 = in1(5,:);
footv3 = in1(6,:);
footwm1 = in2(4,:);
footwm2 = in2(5,:);
footwm3 = in2(6,:);
footquat1 = in1(7,:);
footquat2 = in1(8,:);
footquat3 = in1(9,:);
footquat4 = in1(10,:);
footwbias1 = in1(14,:);
footwbias2 = in1(15,:);
footwbias3 = in1(16,:);
footmdist1 = in1(17,:);
footmdist2 = in1(18,:);
footmdist3 = in1(19,:);
mag_north1 = in1(39,:);
mag_north2 = in1(40,:);
mag_north3 = in1(41,:);
r1a1 = in5(1,:);
r1a2 = in5(2,:);
r1a3 = in5(3,:);
r2a1 = in6(1,:);
r2a2 = in6(2,:);
r2a3 = in6(3,:);
rcop1 = in7(1,:);
rcop2 = in7(2,:);
rcop3 = in7(3,:);
shankp1 = in1(20,:);
shankp2 = in1(21,:);
shankp3 = in1(22,:);
shankquat1 = in1(26,:);
shankquat2 = in1(27,:);
shankquat3 = in1(28,:);
shankquat4 = in1(29,:);
shankmdist1 = in1(36,:);
shankmdist2 = in1(37,:);
shankmdist3 = in1(38,:);
t2 = footquat1.^2;
t3 = footquat2.^2;
t4 = footquat3.^2;
t5 = footquat4.^2;
t6 = shankquat1.^2;
t7 = shankquat2.^2;
t8 = shankquat3.^2;
t9 = shankquat4.^2;
t10 = -footwbias1;
t11 = -footwbias2;
t12 = -footwbias3;
t13 = footwm1+t10;
t14 = footwm2+t11;
t15 = footwm3+t12;
t25 = t2+t3+t4+t5;
t26 = t6+t7+t8+t9;
t16 = rcop2.*t13;
t17 = rcop1.*t14;
t18 = rcop3.*t13;
t19 = rcop1.*t15;
t20 = rcop3.*t14;
t21 = rcop2.*t15;
t27 = 1.0./t26;
t28 = 1.0./t25;
t22 = -t17;
t23 = -t19;
t24 = -t21;
t32 = footquat1.*footquat2.*t28.*2.0;
t33 = footquat1.*footquat3.*t28.*2.0;
t34 = footquat1.*footquat4.*t28.*2.0;
t35 = footquat2.*footquat3.*t28.*2.0;
t36 = footquat2.*footquat4.*t28.*2.0;
t37 = footquat3.*footquat4.*t28.*2.0;
t38 = t6.*t27;
t39 = t7.*t27;
t40 = t8.*t27;
t41 = t9.*t27;
t42 = shankquat1.*shankquat2.*t27.*2.0;
t43 = shankquat1.*shankquat3.*t27.*2.0;
t44 = shankquat1.*shankquat4.*t27.*2.0;
t45 = shankquat2.*shankquat3.*t27.*2.0;
t46 = shankquat2.*shankquat4.*t27.*2.0;
t47 = shankquat3.*shankquat4.*t27.*2.0;
t48 = t2.*t28;
t49 = t3.*t28;
t50 = t4.*t28;
t51 = t5.*t28;
t29 = t16+t22;
t30 = t18+t23;
t31 = t20+t24;
t52 = -t35;
t53 = -t36;
t54 = -t37;
t55 = t39.*2.0;
t56 = t40.*2.0;
t57 = t41.*2.0;
t58 = -t45;
t59 = -t46;
t60 = -t47;
t61 = t49.*2.0;
t62 = t50.*2.0;
t63 = t51.*2.0;
t64 = -t39;
t66 = -t40;
t68 = -t41;
t70 = -t49;
t72 = -t50;
t74 = -t51;
t76 = t42+t47;
t77 = t43+t46;
t78 = t44+t45;
t79 = t32+t37;
t80 = t33+t36;
t81 = t34+t35;
t65 = -t55;
t67 = -t56;
t69 = -t57;
t71 = -t61;
t73 = -t62;
t75 = -t63;
t82 = t42+t60;
t83 = t43+t59;
t84 = t44+t58;
t85 = t32+t54;
t86 = t33+t53;
t87 = t34+t52;
t88 = r1a1.*t81;
t89 = r1a2.*t79;
t90 = r1a3.*t80;
t91 = r2a1.*t78;
t92 = r2a2.*t76;
t93 = r2a3.*t77;
t100 = t61+t62-1.0;
t101 = t61+t63-1.0;
t102 = t62+t63-1.0;
t106 = t55+t56-1.0;
t107 = t55+t57-1.0;
t108 = t56+t57-1.0;
t112 = t29.*t80;
t113 = t30.*t79;
t114 = t31.*t81;
t121 = t48+t49+t72+t74;
t122 = t48+t50+t70+t74;
t123 = t48+t51+t70+t72;
t124 = t38+t39+t66+t68;
t125 = t38+t40+t64+t68;
t126 = t38+t41+t64+t66;
t94 = r1a1.*t86;
t95 = r1a2.*t87;
t96 = r1a3.*t85;
t97 = r2a1.*t83;
t98 = r2a2.*t84;
t99 = r2a3.*t82;
t103 = -t91;
t104 = -t92;
t105 = -t93;
t115 = t29.*t85;
t116 = t30.*t87;
t117 = t31.*t86;
t118 = -t113;
t127 = r1a1.*t121;
t128 = r1a2.*t122;
t129 = r1a3.*t123;
t130 = r2a1.*t124;
t131 = r2a2.*t125;
t132 = r2a3.*t126;
t133 = t29.*t123;
t134 = t30.*t122;
t135 = t31.*t121;
t109 = -t94;
t110 = -t95;
t111 = -t96;
t119 = -t115;
t120 = -t117;
yout = [footmdist1+mag_north2.*t81-mag_north3.*t86-mag_north1.*t102;footmdist2+mag_north3.*t79-mag_north1.*t87-mag_north2.*t101;footmdist3+mag_north1.*t80-mag_north2.*t85-mag_north3.*t100;shankmdist1+mag_north2.*t78-mag_north3.*t83-mag_north1.*t108;shankmdist2+mag_north3.*t76-mag_north1.*t84-mag_north2.*t107;shankmdist3+mag_north1.*t77-mag_north2.*t82-mag_north3.*t106;footp1-shankp1+t90+t98+t105+t110-r1a1.*t102+r2a1.*t108;footp2-shankp2+t88+t99+t103+t111-r1a2.*t101+r2a2.*t107;footp3-shankp3+t89+t97+t104+t109-r1a3.*t100+r2a3.*t106;footv1+t112+t116-t31.*t102;footv2+t114+t119+t30.*t101;footv3+t118+t120-t29.*t100;t13;t14;t15];
if nargout > 1
    y_dx = reshape([0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,mag_north3.*t81+mag_north2.*t86,-mag_north2.*t79+mag_north3.*t122,-mag_north3.*t85-mag_north2.*t123,0.0,0.0,0.0,0.0,-t89+t94-t129,t88+t111+t128,0.0,t113+t117-t133,t114+t119-t134,0.0,0.0,0.0,-mag_north1.*t86-mag_north3.*t121,mag_north1.*t79+mag_north3.*t87,-mag_north3.*t80+mag_north1.*t123,0.0,0.0,0.0,t89+t109+t129,0.0,-t90+t95-t127,t118+t120+t133,0.0,-t112-t116-t135,0.0,0.0,0.0,-mag_north1.*t81+mag_north2.*t121,-mag_north2.*t87-mag_north1.*t122,mag_north2.*t80+mag_north1.*t85,0.0,0.0,0.0,-t88+t96-t128,t90+t110+t127,0.0,-t114+t115+t134,t112+t116+t135,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-rcop2.*t80-rcop3.*t87,rcop2.*t85-rcop3.*t101,rcop3.*t79+rcop2.*t100,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,rcop1.*t80+rcop3.*t102,-rcop3.*t81-rcop1.*t85,rcop3.*t86-rcop1.*t100,0.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,rcop1.*t87-rcop2.*t102,rcop2.*t81+rcop1.*t101,-rcop1.*t79-rcop2.*t86,0.0,0.0,-1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,mag_north3.*t78+mag_north2.*t83,-mag_north2.*t76+mag_north3.*t125,-mag_north3.*t82-mag_north2.*t126,0.0,t92-t97+t132,t99+t103-t131,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-mag_north1.*t83-mag_north3.*t124,mag_north1.*t76+mag_north3.*t84,-mag_north3.*t77+mag_north1.*t126,t97+t104-t132,0.0,t93-t98+t130,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-mag_north1.*t78+mag_north2.*t124,-mag_north2.*t84-mag_north1.*t125,mag_north2.*t77+mag_north1.*t82,t91-t99+t131,t98+t105-t130,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,t73+t75+1.0,-t34+t35,t80,t67+t69+1.0,-t44+t45,t77,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,t81,t71+t75+1.0,-t32+t37,t78,t65+t69+1.0,-t42+t47,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t33+t36,t79,t71+t73+1.0,-t43+t46,t76,t65+t67+1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[15,39]);
end
